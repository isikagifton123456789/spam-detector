# Email Spam Detector

A Flask web application that uses machine learning to detect spam emails. This project implements a logistic regression model with TF-IDF vectorization to classify emails as spam or ham (not spam).

## Project Structure

```
spam-detector/
│
├── app.py                 # Main Flask application
├── templates/
│   └── index.html        # Web interface template
├── static/
│   └── style.css         # CSS styling
├── train_model.py        # Script to train the ML model
├── requirements.txt      # Python dependencies
├── logistic_model.pkl    # Trained logistic regression model (generated)
├── count_vectorizer.pkl  # Trained Count vectorizer (generated)
└── README.md            # This file
```

## Features

- **Web Interface**: Clean and modern web interface for email input
- **Real-time Analysis**: Instant spam detection with confidence scores
- **Machine Learning**: Uses logistic regression with Count vectorizer features
- **Responsive Design**: Works on desktop and mobile devices
- **Visual Feedback**: Color-coded results with confidence indicators

## Installation

1. **Clone or download the project files**

2. **Install Python dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

3. **Train the model (first time only):**
   ```bash
   python train_model.py
   ```
   This will create the required `logistic_model.pkl` and `count_vectorizer.pkl` files.

4. **Run the Flask application:**
   ```bash
   python app.py
   ```

5. **Open your browser and go to:**
   ```
   http://localhost:5000
   ```

## Usage

1. Open the web application in your browser
2. Paste or type the email content you want to analyze
3. Click "Analyze Email" to get the spam detection result
4. The result will show:
   - Whether the email is spam or not
   - Confidence percentage
   - Visual indicators with color coding

## Model Training

The included `train_model.py` script uses your actual spam.csv dataset. To train the model:

1. **Ensure spam.csv is available** in one of these locations:
   - `spam-detector/spam.csv` (current directory)
   - `archive (1)/spam.csv` (relative path)
   - Full path to your dataset

2. **Run the training script:**
   ```bash
   python train_model.py
   ```

3. **The script will:**
   - Load your spam.csv dataset
   - Preprocess the text data
   - Train a logistic regression model with Count vectorizer
   - Save the trained model and vectorizer as .pkl files
   - Evaluate the model performance

## API Endpoints

- `GET /` - Main web interface
- `POST /predict` - Spam detection API
  - **Input**: JSON with `email_text` field
  - **Output**: JSON with `is_spam`, `confidence`, and `prediction` fields

## Customization

### Styling
- Modify `static/style.css` to change the appearance
- The CSS includes responsive design and modern gradients

### Model Parameters
- Edit `train_model.py` to adjust:
  - Count vectorizer parameters (max_features, ngram_range)
  - Model parameters (LogisticRegression settings)
  - Text preprocessing steps

### Web Interface
- Modify `templates/index.html` to change the layout
- Add new features like batch processing or file uploads

## Dependencies

- **Flask**: Web framework
- **scikit-learn**: Machine learning library
- **numpy**: Numerical computing
- **pandas**: Data manipulation
- **joblib**: Model serialization and loading

## Notes

- The model files (`*.pkl`) are binary and generated by training
- Make sure to train the model before running the web application
- The sample training data is minimal - use a larger dataset for better accuracy
- Consider implementing additional features like email header analysis for improved detection

## Troubleshooting

1. **"Model files not found" error**: Run `python train_model.py` first
2. **Import errors**: Install dependencies with `pip install -r requirements.txt`
3. **Port already in use**: Change the port in `app.py` or kill existing processes

## Future Enhancements

- Add support for email headers analysis
- Implement neural network models
- Add batch processing capabilities
- Include email attachment scanning
- Add user feedback system for model improvement

## Model Analysis and Comparison

The project includes a comprehensive Jupyter notebook `mail_spam.ipynb` that performs an in-depth analysis of various machine learning models for spam detection:

### Models Evaluated
- Logistic Regression
- Multinomial Naive Bayes
- Gaussian Naive Bayes
- Support Vector Machines (SVM)
- Decision Trees
- Random Forests
- Gradient Boosting
- XGBoost

### Analysis Features
- Data preprocessing and cleaning
- Text vectorization using CountVectorizer
- Model training and evaluation
- Performance comparison using:
  - Accuracy scores
  - Precision scores
  - Confusion matrices
  - Classification reports
- Visualization of results using matplotlib
- Word clouds for spam vs. ham analysis

### Key Findings
- Logistic Regression emerged as the top performer
- Model saves the best performing model (logistic_model.pkl)
- Includes preprocessing pipeline for text normalization

### Using the Notebook
1. Open `mail_spam.ipynb` in Jupyter Notebook or VS Code
2. Run cells sequentially to:
   - Load and preprocess the dataset
   - Train multiple models
   - Compare performance metrics
   - Generate visualizations
   - Save the best model

The notebook provides valuable insights into model selection and performance optimization for spam detection.
